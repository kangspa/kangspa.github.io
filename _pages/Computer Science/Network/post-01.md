---
title: 클라이언트 인증 방식, JWT
tags:
    - 쿠키
    - 세션
    - 토큰
    - JWT
date: "2024-12-01"
thumbnail: "/assets/img/Computer Science/Network/post-01/thumbnail.png"
---

# Cookie
Key-Value 형식의 문자열, 클라이언트의 브라우저에 설치되는 작은 기록 정보 파일.
1. 클라이언트가 서버에 요청을 보냄
2. 클라이언트 측에 저장하고 싶은 정보를 응답 헤더의 Set-Cookie에 담음
3. 해당 클라이언트는 요청을 보낼 때마다 매번 저장된 쿠키를 요청 헤더의 Cookie에 담아 보냄

### 단점
- 보안에 취약
- 용량 제한
- 브라우저 간 공유가 불가능
- 쿠키 사이즈가 클수록 네트워크에 부하가 심해짐

# Session
비밀번호 등 민감한 인증 정보는 서버 측에 저장하고 관리하는 방식.
Key에 해당하는 SESSION ID와 이에 대응하는 Value 값으로 구성되어 있다.
1. 유저가 웹사이트 로그인 시 세션이 서버(or DB)에 저장
2. 서버에서는 브라우저 쿠키에 Session Id 저장
3. 쿠키에 정보가 있기에 브라우저는 모든 Request에 Session Id를 쿠키에 담아 전송
4. 서버는 클라이언트가 보낸 Session Id 와 서버 메모리로 관리 중인 Session Id를 비교하여 인증 수행

### 단점
- 세션 ID 자체는 유의미한 정보가 없어 보안상 괜찮을 수 있으나, 세션 ID 자체를 탈취 당하면 클라이언트인척 위장하여 문제가 발생할 수 있다. (서버에서 IP 특정을 통해 해결 가능)
- 세션 저장소를 사용하므로 요청이 많아지면 서버에 부하가 생긴다.
    매번 Session ID를 비교하고 인증이 통과되므로 인증에 시간이 오래 걸린다.

# Token
해당 클라이언트가 서버로부터 인증되면 유일한 토큰을 발급해서 이를 통해 인증을 유지하는 방식.
서버에 요청을 보낼 때 헤더에 토큰을 심어서 보낸 후 인증해주며, 클라이언트에 저장되므로 서버 부담을 덜 수 있다.
보통 앱과 서버가 통신 및 인증 시 많이 사용되는데, 웹에는 쿠키와 세션이 있지만 앱에는 없기 때문!
1. 사용자 로그인
2. 토큰 발급
3. 클라이언트는 쿠키나 스토리지에 저장해두고, 요청 시 HTTP 헤더에 포함해 전달
4. 서버는 토큰만 확인하고 요청 응답(토큰에 유저 정보가 있으므로 DB 조회 불필요)

### 단점
- 토큰 자체 길이가 길어, 인증요청 많을수록 네트워크 부하가 심해짐
- Payload 자체는 암호화되지 않으므로 중요 정보는 담을 수 없음
- 토큰 탈취 당할 경우 대처가 어려움

# JWT (Json Web Token)
Json 객체에 인증에 필요한 정보들을 담은 후 비밀키로 서명한 토큰(인터넷 표준 인증 방식).
인증(Authenticatoin) & 권한허가(Authorization) 방식으로 사용된다.
Base64 URL-safe Encode로 직렬화한 것이며, 전자서명도 들어있다.

### 구조
![Image1](/assets/img/Computer Science/Network/post-01/1.png)
1. Header
    alg : 서명 암호화 알고리즘
    typ : 토큰 유형
2. Payload : 실사용될 정보 조각들인 Claim 포함
    정해진 데이터 타입은 없으나, `Registered claims`, `Public claims`, `Private claims` 대표적 3가지로 나뉜다.
3. Signature : 구조는 (헤더+페이로드)와 시크릿 키를 합친 것이고, 헤더에서 정의한 알고리즘으로 암호화됨
    시그니처는 서버가 관리하는 비밀키가 유출되지 않는 이상 복호화가 불가하여, 토큰 위변조 여부 확인에 사용된다!

- **Access Token** : 클라이언트가 갖고있는 실제 유저 정보가 담긴 토큰, 해당 토큰으로 응답 진행
- **Refresh Token** : 액세스 토큰 발급을 위해 사용되는 토큰으로, 보통 DB에 유저 정보와 같이 기록

---

- 출처 및 참고
    - <https://inpa.tistory.com/entry/WEB-📚-JWTjson-web-token-란-💯-정리>
    - <https://youtu.be/XXseiON9CV0>
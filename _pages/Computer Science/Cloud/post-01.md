---
title: VPC부터 네트워크까지
tags:
    - VPN
    - VPC
    - AWS
    - 서브넷
    - 라우팅
date: "2024-12-01"
thumbnail: "https://miro.medium.com/v2/resize:fit:1100/format:webp/1*I_3RxWyOPMj9lQs1xhEebg.png"
---
<a style="font-size:0.9rem" href="https://medium.com/harrythegreat/aws-가장쉽게-vpc-개념잡기-71eef95a7098">- 출처 : [AWS] 가장쉽게 VPC 개념잡기 중</a>

- **VPN** : Virtual Private Network(가상사설망), 보안상 문제 등으로 인해 네트워크 분리가 필요할 경우 사용

# VPC (Virtual Private Cloud)
VPC 별로 네트워크 구성을 하여 인스턴스들을 묶어주기 위해 사용한다.
만약 VPC가 없다면, 인스턴스 간 연결과 인터넷 연결이 거미줄처럼 연결되며 시스템 복잡도를 높이고, 하나의 인스턴스만 추가되도 모든 인스턴스를 수정해야하는 번거로움이 발생
![VPC없는 구조](https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hZGJeN-4F6fLtus5XBJC_w.png)
<p style="font-size:0.9rem">- 출처 : [AWS] 가장쉽게 VPC 개념잡기 중</p>

## 구성방법
- 아이피범위를 RFC1918 이라는 사설아이피대역에 맞추어 구축해야함
    - 10.0.0.0 ~ 10.255.255.255(10/8 prefix)
    - 172.16.0.0 ~ 172.31.255.255(182.16/12 prefix)
    - 192.168.0.0 ~ 192.168.255.255(192.168/16 prefix)
- 한번 설정된 아이피대역은 수정할 수 없으며, 각 VPC는 하나의 리전에 종속되며, 각각의 VPC는 완전 독립적이다.

## 서브넷
- VPC를 더욱 잘개 쪼개는 과정으로, VPC보다 작은단위이므로 더 작은 아이피범위값을 갖게됨.
- 더 많은 네트워크망을 만들기 위해 존재하며, 가용영역 안에 존재하므로 리소스들을 위치시킬 수 있음.

---

# 라우팅 테이블
- **라우터** : 네트워크 사이에서 데이터 전달 장치이자, 서로 다른 네트워크를 연결해주는 장치
- **라우팅 테이블** : IP 주소 기반으로 라우터 위치를 저장한 테이블

## 구성 요소
1. 네트워크 대상 : 목적지 네트워크의 IP 주소
2. 서브넷 마스크 : 대상 주소를 설명할 때 쓰이는 값
3. 게이트웨이 : 해당 장치와 연결된 홉, 패킷이 전달되는 다음 IP 주소(외부 네트워크와 연결된 장치)
    만약 목적지가 로컬네트워크라면 '연결됨', 외부 네트워크라면 해당 네트워크의 게이트웨이를 표기
4. 인터페이스 : 게이트웨이로 가기위해 거치는 장치
5. 메트릭 : 우선순위와 비슷한 개념으로 패킷 전송을 위해 최적 경로가 선택되도록 참고되는 값

- 외부로 통하는 트래픽 처리가 불가하므로 '인터넷 게이트웨이'를 사용한다!

---

# 인터넷 게이트웨이
VPC와 인터넷을 연결해주는 하나의 관문(게이트웨이)이다.
- **퍼블릭서브넷** : 인터넷과 연결된 서브넷
- **프라이빗서브넷** : 인터넷과 연결되지 않는 서브넷

# 네트워크 ACL & 보안그룹
방화벽과 같은 역할로, 인바운드 트래픽과 아웃바운드 트래픽 보안정책을 설정할 수 있다.
- 보안그룹 : Stateful 동작, 모든 트래픽 차단이 default(필요 설정은 허용)
    - 각각의 보안그룹별로 트래픽 설정이 가능하며, 서브넷 및 각각의 리소스에도 적용가능하다.
- 네트워크ACL : Stateless 동작, 모든 트래픽 허용이 default(불필요한 트래픽을 차단 필요)
    - 서브넷 단위로 적용되며 리소스별로는 설정할 수 없다.
- 서로 충돌할 경우, 보안그룹이 더 높은 우선순위를 갖는다!

# NAT 게이트웨이
- 프라이빗 서브넷이 인터넷과 통신하기 위한 아웃바운드 인스턴스
- 프라이빗 서브넷은 인바운드는 필요없어도 아웃바운드 트래픽은 허용되야하는 경우가 있기에 사용

---

- 출처 및 참고
    - [AWS VPC 쉽게 개념잡기](https://medium.com/harrythegreat/aws-가장쉽게-vpc-개념잡기-71eef95a7098)
    - [라우팅 개념과 라우터, 라우팅 테이블](https://jhlee-developer.tistory.com/entry/CS-라우팅-개념과-라우터-라우팅-테이블)
    - [Amazon VPC란 무엇인가?](https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/what-is-amazon-vpc.html)